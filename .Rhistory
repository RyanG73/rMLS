install.packages("learnr")
getwd()
?paste0
?html_table
??html_table
?as_tibble
??as_tibble
library(tidyverse)
?distinct
?str_replace_all
?as.integer
?mutate
?rename
?cbind
?save
?filter
source('~/rProjects/rMLS/R/seasons.R', echo=TRUE)
htmlTable
rvest::html_table
source('~/rProjects/rMLS/R/seasons.R', echo=TRUE)
table %>% rvest::html_table
table1 <- table %>% rvest::html_table
rvest::html_table
table
table1
URL <- paste0("https://fbref.com/en/comps/22/history/Major-League-Soccer-Seasons")
html_doc <- URL %>% xml2::read_html()
table <- html_doc %>% rvest::html_nodes("table")
table1 <- table %>% rvest::html_table
df <- as.data.frame(table1)
df
table
table %>% rvest::html_table
table %>% rvest::html_table()
source('~/rProjects/rMLS/R/seasons.R', echo=TRUE)
??html_attr
source('~/rProjects/rMLS/R/seasons.R', echo=TRUE)
source('~/rProjects/rMLS/R/seasons.R', echo=TRUE)
load("~/rProjects/rMLS/data/seasons.RData")
load("~/rProjects/rMLS/data/seasons.RData")
hi <- load("~/rProjects/rMLS/data/seasons.RData")
load("~/rProjects/rMLS/data/seasons.RData")
View(df)
source('~/rProjects/rMLS/R/seasons.R', echo=TRUE)
View(seasons)
getwd()
matches <- readr::read_csv("https://projects.fivethirtyeight.com/soccer-api/club/spi_matches.csv")
View(matches)
matches <- matches %>%
dplyr::filter(league == 'Major League Soccer')
fte_matches <- function(start_season=2017,end_season=2020){
matches <- readr::read_csv("https://projects.fivethirtyeight.com/soccer-api/club/spi_matches.csv")
matches <- matches %>%
dplyr::filter(league == 'Major League Soccer') %>%
dplyr::filter(season == start_season) %>%
dplyr::filter(season == end_season)
}
fte_matches()
ryan <- fte_matches()
View(ryan)
ryan <- fte_matches(2018,2019)
View(ryan)
fte_matches <- function(start_season=2017,end_season=2020){
matches <- readr::read_csv("https://projects.fivethirtyeight.com/soccer-api/club/spi_matches.csv")
matches <- matches %>%
dplyr::filter(league == 'Major League Soccer') %>%
dplyr::filter(season == start_season) %>%
dplyr::filter(season == end_season)
return(matches)
}
ryan <- fte_matches(2018,2019)
View(ryan)
ryan <- fte_matches()
matches <- readr::read_csv("https://projects.fivethirtyeight.com/soccer-api/club/spi_matches.csv")
matches <- matches %>%
dplyr::filter(league == 'Major League Soccer') %>%
dplyr::filter(season == 2017) %>%
dplyr::filter(season == 2018)
matches <- readr::read_csv("https://projects.fivethirtyeight.com/soccer-api/club/spi_matches.csv")
View(matches)
glimpse(matches)
fte_matches <- function(start_season=2017,end_season=2020){
matches <- readr::read_csv("https://projects.fivethirtyeight.com/soccer-api/club/spi_matches.csv")
matches <- matches %>%
dplyr::filter(league == 'Major League Soccer') %>%
dplyr::filter(season >= start_season) %>%
dplyr::filter(season <= end_season)
return(matches)
}
ryan <- fte_matches()
View(ryan)
ryan <- fte_matches(2018,2020)
View(ryan)
getwd()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
usethis::use_pipe()
devtools::document()
devtools::document()
usethis::use_pipe()
devtools::document()
usethis::use_pipe()
devtools::document()
devtools::document()
library(tidyverse)
library(tidyverse)
designated_players <- read_csv("~/rProjects/Soccer/designated_players.csv")
homegrown <- read_csv("~/rProjects/Soccer/homegrown.csv")
team_info <- read_csv("~/rProjects/Soccer/team_info.csv")
historical_odds <- read_csv("~/rProjects/Soccer/MLS_odds.csv")
salaries <- read_csv("~/rProjects/Soccer/MLS_Salaries.csv")
draft <- read_csv("~/rProjects/Soccer/draft_complete.csv")
View(designated_players)
View(draft)
View(historical_odds)
View(homegrown)
View(salaries)
View(team_info)
getwd()
save(designated_players, file="data/designated_players.RData")
save(homegrown, file="data/homegrown.RData")
save(team_info, file="data/team_info.RData")
save(historical_odds, file="data/historical_odds.RData")
save(salaries, file="data/salaries.RData")
save(draft, file="data/draft.RData")
load("~/rProjects/rMLS/data/historical_odds.RData")
View(historical_odds)
glimpse(historical_odds)
library(tidyverse)
glimpse(historical_odds)
table(historical_odds$Country)
table(historical_odds$League)
table(historical_odds$Season)
as.Date(historical_odds$Date)
?as.Date
as.Date(historical_odds$Date,"%d/%m/%Y", tryFormats = c("%d/%m/%y", "%d/%m/%Y"))
as.Date(historical_odds$Date,"%d/%m/%y", tryFormats = c("%d/%m/%y", "%d/%m/%Y"))
library(lubridate)
lubridate::dmy(historical_odds$Date)
historical_odds$Date <- lubridate::dmy(historical_odds$Date)
glimpse(historical_odds)
table(historical_odds$Date)
View(historical_odds)
glimpse(historical_odds)
#as.Date(historical_odds$Date,"%d/%m/%y", tryFormats = c("%d/%m/%y", "%d/%m/%Y"))
unique(historical_odds$Home)
#as.Date(historical_odds$Date,"%d/%m/%y", tryFormats = c("%d/%m/%y", "%d/%m/%Y"))
unique(historical_odds$Away)
historical_odds %>% rename(iris, home_goals = HG)
historical_odds %>% rename(home_goals = HG)
glimpse(historical_odds)
historical_odds %>% rename(home_goals = HG,
away_gaols = AG)
glimpse(historical_odds)
historical_odds %>% rename(home_goals = HG,
away_gaols = AG,
winning_side = Res,
pinnacle_home_odds = PH,
pinnacle_draw_odds = PD,
pinnacle_away_odds = PA,
maximum_home_odds = MaxH,
maximum_draw_odds = MaxD,
maximum_away_odds = MaxA,
average_home_odds = AvgH,
average_draw_odds = AvgD,
average_away_odds = AvgA)
historical_odds <- historical_odds %>% rename(home_goals = HG,
away_gaols = AG,
winning_side = Res,
pinnacle_home_odds = PH,
pinnacle_draw_odds = PD,
pinnacle_away_odds = PA,
maximum_home_odds = MaxH,
maximum_draw_odds = MaxD,
maximum_away_odds = MaxA,
average_home_odds = AvgH,
average_draw_odds = AvgD,
average_away_odds = AvgA)
glimpse(historical_odds)
names(historical_odds)<-tolower(names(historical_odds))
glimpse(historical_odds)
a <- ifelse(historical_odds$average_home_odds >= 2,(historical_odds$average_home_odds - 1) * 100,(-100)/(historical_odds$average_home_odds - 1))
a
a <- round(ifelse(historical_odds$average_home_odds >= 2,(historical_odds$average_home_odds - 1) * 100,(-100)/(historical_odds$average_home_odds - 1)),0)
a
historical_odds$american_draw_odds <- round(ifelse(historical_odds$average_draw_odds >= 2,(historical_odds$average_draw_odds - 1) * 100,(-100)/(historical_odds$average_draw_odds - 1)),0)
historical_odds$american_away_odds <- round(ifelse(historical_odds$average_away_odds >= 2,(historical_odds$average_away_odds - 1) * 100,(-100)/(historical_odds$average_away_odds - 1)),0)
glimpse(historical_odds)
historical_odds$american_home_odds <- round(ifelse(historical_odds$average_home_odds >= 2,(historical_odds$average_home_odds - 1) * 100,(-100)/(historical_odds$average_home_odds - 1)),0)
historical_odds$american_draw_odds <- round(ifelse(historical_odds$average_draw_odds >= 2,(historical_odds$average_draw_odds - 1) * 100,(-100)/(historical_odds$average_draw_odds - 1)),0)
historical_odds$american_away_odds <- round(ifelse(historical_odds$average_away_odds >= 2,(historical_odds$average_away_odds - 1) * 100,(-100)/(historical_odds$average_away_odds - 1)),0)
glimpse(historical_odds)
abs(-1)
historical_odds$implied_home_probability <- ifelse(historical_odds$american_home_odds>0,(100/(historical_odds$american_home_odds + 100)),(abs(historical_odds$american_home_odds)/(abs(historical_odds$american_home_odds) +100)))
glimpse(historical_odds)
historical_odds$implied_home_probability <- round(ifelse(historical_odds$american_home_odds>0,(100/(historical_odds$american_home_odds + 100)),(abs(historical_odds$american_home_odds)/(abs(historical_odds$american_home_odds) +100))),2)
glimpse(historical_odds)
historical_odds$implied_home_probability <- round(ifelse(historical_odds$american_home_odds>0,(100/(historical_odds$american_home_odds + 100)),(abs(historical_odds$american_home_odds)/(abs(historical_odds$american_home_odds) +100))),2)
historical_odds$implied_draw_probability <- round(ifelse(historical_odds$american_draw_odds>0,(100/(historical_odds$american_draw_odds + 100)),(abs(historical_odds$american_draw_odds)/(abs(historical_odds$american_draw_odds) +100))),2)
historical_odds$implied_away_probability <- round(ifelse(historical_odds$american_away_odds>0,(100/(historical_odds$american_away_odds + 100)),(abs(historical_odds$american_away_odds)/(abs(historical_odds$american_away_odds) +100))),2)
glimpse(historical_odds)
historical_odds %>%
mutate(true_home_probability = implied_home_probability / (implied_home_probability + implied_draw_probability + implied_away_probability))
historical_odds <- historical_odds %>%
mutate(true_home_probability = implied_home_probability / (implied_home_probability + implied_draw_probability + implied_away_probability)) %>%
mutate(true_draw_probability = implied_draw_probability / (implied_home_probability + implied_draw_probability + implied_away_probability)) %>%
mutate(true_away_probability = implied_away_probability / (implied_home_probability + implied_draw_probability + implied_away_probability))
glimpse(historical_odds)
historical_odds <- historical_odds %>%
round(mutate(true_home_probability = implied_home_probability / (implied_home_probability + implied_draw_probability + implied_away_probability)),2) %>%
round(mutate(true_draw_probability = implied_draw_probability / (implied_home_probability + implied_draw_probability + implied_away_probability)),2) %>%
round(mutate(true_away_probability = implied_away_probability / (implied_home_probability + implied_draw_probability + implied_away_probability)),2)
glimpse(historical_odds)
historical_odds <- historical_odds %>%
mutate(true_home_probability = implied_home_probability / (implied_home_probability + implied_draw_probability + implied_away_probability)) %>%
mutate(true_draw_probability = implied_draw_probability / (implied_home_probability + implied_draw_probability + implied_away_probability)) %>%
mutate(true_away_probability = implied_away_probability / (implied_home_probability + implied_draw_probability + implied_away_probability))
historical_odds %>%
round(true_home_probability,2)
historical_odds
?round
historical_odds %>%
round(historical_odds$true_home_probability,2)
historical_odds$true_home_probability <- round(historical_odds$true_home_probability ,digit=2)
glimpse(historical_odds)
historical_odds$true_draw_probability <- round(historical_odds$true_draw_probability ,digit=2)
historical_odds$true_away_probability <- round(historical_odds$true_away_probability ,digit=2)
historical_odds
glimpse(historical_odds)
save(historical_odds, file = "data/historical_odds.RData")
load("~/rProjects/rMLS/data/designated_players.RData")
View(designated_players)
library(tidyverse)
library(readr)
players <- read_csv("~/rProjects/Soccer/players.csv")
View(players)
j <- left_join(designated_players,players,by=c('player' = 'player_name'))
View(j)
j <- distinct(j)
getwd()
write.csv(x=j, file="/Users/ryangerda//Desktop/j.csv",row.names = F)
View(historical_odds)
r <- read_csv("/Users/ryangerda//Desktop/j.csv")
View(r)
r <- read_csv("/Users/ryangerda//Desktop/j.csv")
View(r)
designated_players <- read_csv("/Users/ryangerda//Desktop/j.csv")
save(designated_players, file = "data/designated_players.RData")
load("~/rProjects/rMLS/data/draft.RData")
View(draft)
load("~/rProjects/rMLS/data/homegrown.RData")
View(homegrown)
library(tidyverse)
j <- left_join(homegrown,players,by=c('player' = 'player_name'))
library(readr)
players <- read_csv("~/rProjects/Soccer/players.csv")
View(players)
j <- left_join(homegrown,players,by=c('player' = 'player_name'))
j <- distinct(j)
write.csv(x=j, file="/Users/ryangerda//Desktop/homegrown.csv",row.names = F)
homegrown <- read_csv("/Users/ryangerda//Desktop/homegrown.csv")
View(homegrown)
unique(homegrown$position)
oldValue <- c("Goalkeeper","Defender","Midfielder","Forward","DF","MF","FW","GK")
newValue <- c("Goalkeeper","Defender","Midfielder","Forward","Defender","Midfielder","Forward","Goalkeeper")
results <- mapValues(homegrown$position, oldValue, newValue)
?mapvalues
??mapvalues
library(plyr)
results <- mapValues(homegrown$position, oldValue, newValue)
??mapvalues
results <- mapvalues(homegrown$position, oldValue, newValue)
results
homegrown$position <- mapvalues(homegrown$position, oldValue, newValue)
save(homegrown, file = "data/homegrown.RData")
load("~/rProjects/rMLS/data/salaries.RData")
View(salaries)
library(readr)
players <- read_csv("~/rProjects/Soccer/players.csv")
View(players)
library(tidyverse)
names(salaries)
names(salaries)<-tolower(names(salaries))
names(salaries)
salaries <- salaries %>% rename(team = 'club (grouped)')
salaries <- salaries %>% rename(team = `club (grouped)`)
names(salaries)
?rename
salaries <- salaries %>% rename_with( ~ tolower(gsub(" ", "_", .x, fixed = TRUE)))
names(salaries)
salaries <- salaries %>% rename(club=`club_(grouped)`)
salaries <- salaries %>% rename(club = club_(grouped))
salaries <- salaries %>% rename_with( ~ tolower(gsub("(", "_", .x, fixed = TRUE)))
salaries <- salaries %>% rename_with( ~ tolower(gsub(")", "_", .x, fixed = TRUE)))
names(salaries)
salaries <- salaries %>% rename(club = club__grouped_)
salaries <- salaries %>% rename(club == club__grouped_)
salaries <- salaries %>% rename_with( ~ tolower(gsub("_", "", .x, fixed = TRUE)))
names(salaries)
salaries <- salaries %>% rename(club = clubgrouped)
names(salaries)
salaries$clubgrouped <- NULL
names(salaries)
salaries <- salaries %>% rename(first = firstname,
last = lastname,
total = totalcompensation,
salary = basesalary)
names(salaries)
salaries <- salaries %>% rename(first = firstname,
last = lastname,
total = totalcompensation,
salary = basesalary)
library(tidyverse)
salaries <- salaries %>% rename(first = firstname,
last = lastname,
total = totalcompensation,
salary = basesalary)
names(salaries)
save(salaries, file = "data/salaries.RData")
load("~/rProjects/rMLS/data/salaries.RData")
View(salaries)
salaries$totalcompensation <- as.numeric(gsub('[$,]', '', salaries$totalcompensation))
salaries$basesalary <- as.numeric(gsub('[$,]', '', salaries$basesalary))
unique(salaries$position)
oldValue <- c("F","M","GK","F-M","D","D-M","F/M","M-F","M-D","M/F","D/F","D/M","M/D","MF","D-F","F-D")
newValue <- c("Forward","Midfielder","Goalkeeper","Forward","Defender","Defender","Forward","Midfielder","Midfielder","Midfielder","Defender","Defender","Midfielder","Midfielder","Defender","Forward")
salaries$position <- mapvalues(salaries$position, oldValue, newValue)
salaries$fullname <- paste(salaries$firstname,salaries$lastname)
j <- left_join(salaries,players,by=c('fullname' = 'player_name'))
View(j)
View(salaries)
